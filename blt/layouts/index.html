{{- define "main" -}}
{{ $count := 0 }}
{{ $zipmap := newScratch }}
{{ range .Site.Data.boston_license.records }}
{{ if strings.Contains (index . 4) "Neighborhood Restricted" }}
{{ $count = add $count 1 }}
{{ $zipmap.Add (index . 22) 1 }}
{{ end }}
{{ end }}

<p>There are currently {{ .Site.Data.boston_license.records | len }} licenses.</p>
<p>{{ $count }} are "Neighborhood Restricted"</p>

<h1>Restricted Zipcodes</h1>
These are the zipcodes some of the liquor licenses are restricted to:

<ul>
  {{ range .Site.Data.restricted_zips }}
  <li>{{ . }} licenses: {{ $zipmap.Get . | default 0}}</li>
  {{ end }}
</ul>


<h2>Neighbor restricted licenses {{ $count }}</h2>
{{ range .Site.Data.boston_license.records }}
{{ if strings.Contains (index . 4) "Neighborhood Restricted" }}
<p>{{ index . 1 }} {{ index . 7 }}  {{ index . 8 }} {{ index . 4 }} {{ index . 22 }} </p>
{{ end }}
{{ end }}

{{ .Content }}

{{- end -}}
